"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(e,n,t){"undefined"!=typeof module&&module.exports?module.exports=t():"undefined"!=typeof layui?layui.define(function(n){n(e,t())}):n&&(n[e]=t())}("minare","object"!==("undefined"==typeof window?"undefined":_typeof(window))?void 0:window,function(){return function n(){function e(){return{url:"",handler:{onComplete:null,onTimeout:null,onUploadProgress:null,statusHandlerMapping:{}},header:{},timeout:0}}function t(n){return n&&"function"==typeof n?n:function(){}}function o(n,e){return n&&"function"==typeof n?n:e?null:function(){}}function f(n,e){return n.handler?n.handler.statusHandlerMapping[c(e)]:null}function r(u,i,a){var s=new XMLHttpRequest;s.open(u,p.url+i);var l=!0,d=new e;return{onSuccess:function(n){return d.handler.statusHandlerMapping[c(200)]=o(n,!0),this},onError:function(n){return d.handler.statusHandlerMapping[c(500)]=o(n,!0),d.handler.statusHandlerMapping[c(502)]=o(n,!0),d.handler.statusHandlerMapping[c(503)]=o(n,!0),this},onComplete:function(n){return d.handler.onComplete=o(n,!0),this},onTimeout:function(n){return d.handler.onTimeout=o(n,!0),this},onUploadProgress:function(n){d.handler.onUploadProgress=o(n,!0)},setHeader:function(n,e){return s.setRequestHeader(n,e),this},stringResponse:function(){return l=!1,this},$xhr:function(n){return n(s),this},execute:function(){s.onreadystatechange=function(){var n,e,t,o;4===s.readyState&&(n=s.status,e=f(d,n),t=f(p,n),o=function(e){if(l)try{return JSON.parse(e.responseText)}catch(n){return console.warn("error convert to json data,return response text"),e.responseText}return e.responseText}(s),e?e(o,n):t&&t(o,n),d.handler.onComplete?d.handler.onComplete(o,n):p.handler.onComplete&&p.handler.onComplete(o,n))};for(var n=Object.getOwnPropertyNames(p.header),e=0;e<n.length;e++){var t=n[e],o=p.header[t];s.setRequestHeader(t,"function"==typeof o?o({method:u,url:i,body:a}):o)}if(s.timeout=p.timeout,s.ontimeout=function(n){d.handler.onTimeout?d.handler.onTimeout(n):p.handler.onTimeout&&p.handler.onTimeout(n)},s.upload.onprogress=function(n){d.handler.onUploadProgress?d.handler.onUploadProgress(n):p.handler.onUploadProgress&&p.handler.onUploadProgress(n)},void 0===a)s.send(null);else if(a instanceof FormData||a instanceof File||a instanceof Blob||"string"==typeof a)s.send(a);else{var r=a;try{r=JSON.stringify(a)}catch(n){}s.send(r)}}}}var c=function(n){return"status_"+n},p=new e,u={when:function(n,e){return p.handler.statusHandlerMapping[c(n)]=t(e),this},whenTimeout:function(n){return p.handler.onTimeout=t(n),this},whenComplete:function(n){return p.handler.onComplete=t(n),this},whenUploadProgress:function(n){return p.handler.onUploadProgress=t(n),this},timeout:function(n){return p.timeout="number"==typeof n?n:0,this},addRequestHeader:function(n,e){return n&&e&&(p.header[n]=e),this}};return{newInstance:n,config:function(n){return"function"==typeof n&&n(u),Object.assign({},p)},newGet:function(n){return new r("GET",n)},newPost:function(n,e){return new r("POST",n,e)},newPut:function(n,e){return new r("PUT",n,e)},newDelete:function(n,e){return new r("DELETE",n,e)}}}()});